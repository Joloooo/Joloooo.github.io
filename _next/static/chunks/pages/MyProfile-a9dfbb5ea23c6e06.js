(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61],{8992:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/MyProfile",function(){return a(666)}])},666:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>u});var n=a(4848),t=a(6540),l=a(9026),o=a(1311),r=a.n(o),i=a(1468),c=a(4523),d=a(6715);let u=()=>{let e=(0,d.useRouter)(),s=(0,i.wA)(),[a,o]=(0,t.useState)(null),[u,p]=(0,t.useState)("AccountInfo"),[h,f]=(0,t.useState)(!0),[m,v]=(0,t.useState)(!1),[x,j]=(0,t.useState)(!0),[y,w]=(0,t.useState)(""),[g,P]=(0,t.useState)(""),[_,N]=(0,t.useState)(""),[b,I]=(0,t.useState)({password:"",accountInfo:"",personalInfo:""});(0,t.useEffect)(()=>{{v(window.innerWidth<=1024);let e=()=>v(window.innerWidth<=1024);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}},[]),(0,t.useEffect)(()=>{(async()=>{try{let e=await l.A.get("/loggedUserData");o(e.data.data)}catch(e){console.error("Error fetching profile data:",e),I(e=>({...e,accountInfo:"Failed to load profile data."}))}finally{f(!1)}})()},[]),(0,t.useEffect)(()=>{let e=()=>v(window.innerWidth<=1024);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let A=async(e,s)=>{try{let a=localStorage.getItem("token");(await l.A.post("/updateProfile",e,{headers:{Authorization:"Bearer ".concat(a)}})).data.success&&I(e=>({...e,[s]:"Profile updated successfully!"}))}catch(e){console.error("Error updating profile:",e),I(e=>({...e,[s]:"Failed to update profile. Please try again."}))}},C=async e=>{if(!a)return;let s={};"accountInfo"===e?s={username:a.username,email:a.email,mobile:a.mobile}:"personalInfo"===e?s={firstName:a.firstName,lastName:a.lastName,gender:a.gender,birthdate:a.birthdate}:"password"===e&&(s={password:g}),await A(s,e)},E=()=>j(!0),k=e=>(0,n.jsxs)("div",{className:"".concat(r()["active-content"]," ").concat(m?"":r().flex),children:[m&&(0,n.jsx)("button",{className:r()["back-button"],onClick:E,children:"Back"}),e]}),M=e=>{p(e),I({password:"",accountInfo:"",personalInfo:""})},F=(0,n.jsxs)("div",{className:r()["myProfile-input-div"],children:[(0,n.jsx)("h3",{children:"Manage Your Password"}),(0,n.jsxs)("div",{className:r()["myProfile-input-div-password"],children:[(null==a?void 0:a.hasPassword)&&(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{children:"Old Password:"}),(0,n.jsx)("input",{type:"password",placeholder:"Enter old password",value:y,onChange:e=>w(e.target.value)})]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{children:"New Password:"}),(0,n.jsx)("input",{type:"password",placeholder:"Enter new password",value:g,onChange:e=>P(e.target.value)})]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{children:"Repeat New Password:"}),(0,n.jsx)("input",{type:"password",placeholder:"Repeat new password",value:_,onChange:e=>N(e.target.value)})]}),(0,n.jsx)("div",{className:r().savebuttonDiv,children:(0,n.jsx)("button",{className:r().saveButton,disabled:h,onClick:async()=>{if(g!==_){I(e=>({...e,password:"Passwords do not match!"}));return}try{let e=(null==a?void 0:a.hasPassword)?{oldPassword:y,newPassword:g}:{newPassword:g};await A(e,"password"),I(e=>({...e,password:{type:"success",text:"Password updated successfully!"}}))}catch(e){I(e=>({...e,password:{type:"error",text:"Failed to update password. Please try again."}}))}},children:"Save"})}),b.password&&(0,n.jsx)("div",{className:"string"==typeof b.password?b.password.includes("success")?r()["success-message"]:r()["error-message"]:"success"===b.password.type?r()["success-message"]:r()["error-message"],children:"string"==typeof b.password?b.password:b.password.text})]})]}),S=(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{children:"Manage Your Profile Info"}),h?(0,n.jsx)("div",{children:"Loading..."}):a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:r()["myProfile-input-div"],children:(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{children:"Username:"}),(0,n.jsx)("input",{type:"text",placeholder:"N/A",value:a.username||"",onFocus:()=>I(e=>({...e,accountInfo:""})),onChange:e=>o(s=>s?{...s,username:e.target.value}:null)})]})}),(0,n.jsx)("div",{className:r()["myProfile-input-div"],children:(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{children:"Email:"}),(0,n.jsx)("input",{type:"email",placeholder:"N/A",value:a.email||"",onFocus:()=>I(e=>({...e,accountInfo:""})),onChange:e=>o(s=>s?{...s,email:e.target.value}:null)})]})}),(0,n.jsx)("div",{className:r()["myProfile-input-div"],children:(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{children:"Mobile:"}),(0,n.jsx)("input",{type:"text",placeholder:"N/A",value:a.mobile||"",onFocus:()=>I(e=>({...e,accountInfo:""})),onChange:e=>o(s=>s?{...s,mobile:e.target.value}:null)})]})}),(0,n.jsxs)("div",{className:r()["myProfile-input-div"],children:[(0,n.jsx)("span",{className:r()["status-text"],children:"Status:"}),(0,n.jsx)("span",{className:r().role,children:a.role})]})]}):(0,n.jsx)("div",{children:"Error loading profile data."}),(0,n.jsx)("div",{className:r().savebuttonDiv,children:(0,n.jsx)("button",{className:r().saveButton,disabled:h||!a,onClick:()=>C("accountInfo"),children:"Save"})}),b.accountInfo&&(0,n.jsx)("div",{className:r()["success-message"],children:b.accountInfo})]}),D=(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{children:"Manage Your Personal Info"}),h?(0,n.jsx)("div",{children:"Loading personal info..."}):a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:r()["myProfile-input-div"],children:(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{children:"First Name:"}),(0,n.jsx)("input",{type:"text",placeholder:"N/A",value:a.firstName||"",onFocus:()=>I(e=>({...e,personalInfo:""})),onChange:e=>o(s=>s?{...s,firstName:e.target.value}:null)})]})}),(0,n.jsx)("div",{className:r()["myProfile-input-div"],children:(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{children:"Last Name:"}),(0,n.jsx)("input",{type:"text",placeholder:"N/A",value:a.lastName||"",onFocus:()=>I(e=>({...e,personalInfo:""})),onChange:e=>o(s=>s?{...s,lastName:e.target.value}:null)})]})}),(0,n.jsx)("div",{className:r()["myProfile-input-div"],children:(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{children:"Gender:"}),(0,n.jsx)("input",{type:"text",placeholder:"N/A",value:a.gender||"",onFocus:()=>I(e=>({...e,personalInfo:""})),onChange:e=>o(s=>s?{...s,gender:e.target.value}:null)})]})}),(0,n.jsx)("div",{className:r()["myProfile-input-div"],children:(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{children:"Birthdate:"}),(0,n.jsx)("input",{type:"text",placeholder:"N/A",value:a.birthdate||"",onFocus:()=>I(e=>({...e,personalInfo:""})),onChange:e=>o(s=>s?{...s,birthdate:e.target.value}:null)})]})})]}):(0,n.jsx)("div",{children:"Error loading personal info."}),(0,n.jsx)("div",{className:r().savebuttonDiv,children:(0,n.jsx)("button",{className:r().saveButton,disabled:h||!a,onClick:()=>C("personalInfo"),children:"Save"})}),b.personalInfo&&(0,n.jsx)("div",{className:r()["success-message"],children:b.personalInfo})]}),L=(0,n.jsxs)("div",{className:r()["myProfile-input-div"],children:[(0,n.jsx)("h3",{children:"Delete Account"}),(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{children:"Enter Password:"}),(0,n.jsx)("input",{type:"password",placeholder:"Enter your password",value:y,onChange:e=>w(e.target.value)})]}),(0,n.jsx)("p",{children:(0,n.jsx)("span",{className:r()["warning-text"],children:"If you delete your account, all of your personal information on the website will be immediately and permanently deleted."})}),(0,n.jsx)("div",{className:r().savebuttonDiv,children:(0,n.jsx)("button",{className:r().deleteButton,disabled:h,onClick:async()=>{try{let n=localStorage.getItem("token"),t=null==a?void 0:a.username;if(!t){I(e=>({...e,deleteAccount:"Username is not available."}));return}(await l.A.post("/deleteAccount",{username:t,password:y},{headers:{Authorization:"Bearer ".concat(n)}})).data.success&&(localStorage.removeItem("token"),s((0,c.ri)()),alert("Your account has been deleted and you have been logged out."),e.push("/"))}catch(e){console.error("Error deleting account:",e),I(e=>({...e,deleteAccount:"Failed to delete account. Please try again."}))}},children:"Delete Account"})}),b.deleteAccount&&(0,n.jsx)("div",{className:r()["error-message"],children:b.deleteAccount})]});return h?(0,n.jsx)("div",{className:"left-sided-menu",children:(0,n.jsx)("div",{className:r().loader})}):(0,n.jsx)("div",{className:"".concat(r().myProfile," ").concat(m&&!x?r()["show-content"]:""),children:m&&x?(0,n.jsxs)("div",{className:r()["myProfile-navbar"],children:[(0,n.jsx)("button",{onClick:()=>{M("password"),j(!1)},children:"Password"}),(0,n.jsx)("button",{onClick:()=>{M("AccountInfo"),j(!1)},children:"Account Info"}),(0,n.jsx)("button",{onClick:()=>{M("personalInfo"),j(!1)},children:"Personal Info"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:r()["myProfile-navbar"],children:[(0,n.jsx)("button",{onClick:()=>M("password"),children:"Password"}),(0,n.jsx)("button",{onClick:()=>M("AccountInfo"),children:"Account Info"}),(0,n.jsx)("button",{onClick:()=>M("personalInfo"),children:"Personal Info"}),(0,n.jsx)("button",{onClick:()=>M("deleteAccount"),children:"Delete Account"})]}),(0,n.jsxs)("div",{className:r()["myProfile-content"],children:["password"===u&&k(F),"AccountInfo"===u&&k(S),"personalInfo"===u&&k(D),"deleteAccount"===u&&k(L)]})]})})}},1311:e=>{e.exports={myProfile:"MyProfile_myProfile__nufbW","myProfile-navbar":"MyProfile_myProfile-navbar__FPslT","myProfile-input-div-password":"MyProfile_myProfile-input-div-password__yCWe5",loader:"MyProfile_loader__ZkeDz","myProfile-content":"MyProfile_myProfile-content__vaEEn",role:"MyProfile_role__vT8KF",savebuttonDiv:"MyProfile_savebuttonDiv__q5_Wg",smallloader:"MyProfile_smallloader__LMZIz",l13:"MyProfile_l13__EEU0R",l16:"MyProfile_l16__jN7kF","active-content":"MyProfile_active-content__ntcf1","show-content":"MyProfile_show-content__CZIQX","back-button":"MyProfile_back-button__pqlgq","myProfile-input-div":"MyProfile_myProfile-input-div__j4MLS",saveButton:"MyProfile_saveButton__ubUTg",slideInFromLeft:"MyProfile_slideInFromLeft__Nzhfx"}}},e=>{var s=s=>e(e.s=s);e.O(0,[636,593,792],()=>s(8992)),_N_E=e.O()}]);